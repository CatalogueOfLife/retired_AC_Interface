<?php
/**
 * Annual Checklist Interface
 *
 * tree.phtml
 * Browse tree view
 *
 * @category    ACI
 * @package     application
 * @subpackage  views/scripts
 *
 */
?>
<p class="page_header"><?php echo $this->translate('Browse_taxonomic_tree'); ?></p>
<?php if($this->statisticsModuleEnabled): ?>
<div id="tree-checkboxes">
    <input <?php if($this->showEstimationCheckboxSelected != false) echo 'checked'; ?> id="showStatisticsCheckbox" type="checkbox" name="showEstimates" value="0" onclick="javascript:showOrHide('treeStatistics')" /> 
    <label for="showStatisticsCheckbox"><?php echo $this->textShowStatistics; ?></label>
    <input <?php if($this->showSourceDatabaseCheckboxSelected != false) echo 'checked'; ?> id="showGSDCheckbox" type="checkbox" name="showGSD" value="0" onclick="javascript:showOrHide('treeSourceDatabase')" /> 
    <label for="showGSDCheckbox"><?php echo $this->textShowSourceDatabases; ?></label>
<?php if($this->iconsInTreeModuleEnabled == true): ?>
    <input <?php if($this->showIconsInTreeSelected != false) echo 'checked'; ?> id="showIconsCheckbox" type="checkbox" name="showIcons" value="0" onclick="javascript:showOrHide('iconSpan')" />
    <label for="showIconsCheckbox"><?php echo $this->textShowIcons; ?></label>
<?php endif; ?>    
    
</div>
<?php endif; ?>
<script type="text/javascript">
var baseUrl = "<?php echo $this->baseUrl(); ?>";
var hierarchy = new Array(<?php echo $this->hierarchy; ?>);
<?php echo $this->jsTranslation; ?>
var jsFeedbackUrl = "<?php echo $this->jsFeedbackUrl; ?>";
</script>
<script type="text/javascript">
dojo.require("dijit.TooltipDialog");
var dialog;

initTree = function() {
    var store = new dojox.data.QueryReadStore({ url: baseUrl + '/browse/tree/fetch/taxa' });
    var model = new ACI.dojo.TxStoreModel({
        store: store,
        query: { id: 0 },
        id: 'tree',
        labelAttr: 'name',
        rootLabel: '',
        typeAttr:'type',
        childrenAttr: 'children'
    }, 'store');
    var tree = new ACI.dojo.TxTree({ model: model }, 'tree');
    tree.persist = false;
};

initInfoPanel = function() {
    dialog = new dijit.TooltipDialog({ 
    	"class": "infoPanel"
    });
};

dojo.addOnLoad(initTree);
dojo.addOnLoad(initInfoPanel);
</script>
<div id="tree"></div>