<div class="page_header">
<?php printf($this->title, '"' . $this->key . '"') ?>
</div>
<?php
if ($this->species instanceof ACI_Model_Table_Taxa):
?>
<a href="<?php echo $this->baseUrl() . '/details/database/id/' . $this->species->dbId; ?>"><img
    class="wrapLogo"
    src="<?php echo $this->baseUrl() . $this->species->dbImage; ?>"
    alt="<?php echo $this->species->dbName; ?>"
    title="<?php echo $this->species->dbName; ?>"
/></a>
<p><?php echo $this->species->preface; ?></p>
<table class="details-table">
<?php $rowClass = "even"?>
    <tr class="<?php echo $rowClass; ?>">
        <th width="150" class="vertical"><?php echo $this->translate('Accepted_scientific_name'); ?>:</th>
        <td>
            <table>
                <tr>
                    <td><?php echo $this->species->name; ?></td>
                    <td align="right">
                    <?php if($this->species->references): ?>
                    <a href="<?php echo $this->baseUrl() .
                        '/details/reference/species/' . $this->species->id; ?>"><img
                        src="<?php echo $this->baseUrl() . '/images/book.gif'; ?>"
                        alt="<?php echo $this->species->referencesLabel; ?>"
                        title="<?php echo $this->species->referencesLabel; ?>"/>
                    <?php endif; ?>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd"); ?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Synonyms'); ?>:</th>
        <td>
        <?php if (is_array($this->species->synonyms)): ?>
            <table>
                <?php foreach ($this->species->synonyms as $synonym): ?>
                    <tr>
                        <td><?php
                        echo $synonym['name'] .
                        ' (' . $this->translate($synonym['status']) . ')';
                        ?>
                        </td>
                        <td align="right">
                        <?php if($synonym['num_references']): ?>
                        <a href="<?php echo $this->baseUrl() .
                              '/details/reference/species/' . $synonym['id']; ?>"><img
                            src="<?php echo $this->baseUrl() . '/images/book.gif'; ?>"
                            alt="<?php echo $synonym['referenceLabel']; ?>"
                            title="<?php echo $synonym['referenceLabel'] ?>"/>
                        <?php endif; ?>
                        </td>
                    </tr>
                    <?php endforeach; ?>
                    </table>
                <?php
                else: echo '-'; endif;
                ?>
        </td>
    </tr>
<?php if($this->species->rank != ACI_Model_Table_Taxa::RANK_INFRASPECIES &&
    $this->species->infraspecies): ?>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd"); ?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Infraspecies'); ?>:</th>
        <td><?php foreach ($this->species->infraspecies as $infraspecies):
            echo '<a href="' . $this->baseUrl() . $infraspecies['url'] . '">' .
            $infraspecies['name'] . '</a><br />';
        endforeach;
        ?></td>
    </tr>
<?php endif; ?>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd");?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Common_names'); ?>:</th>
        <td><?php if (is_array($this->species->commonNames)): ?>
            <table>
                <tr>
                    <th width="150px"><?php echo $this->translate('Common_name'); ?></th>
                    <th width="100px"><?php echo $this->translate('Language'); ?></th>
                    <th width="100px"><?php echo $this->translate('Country'); ?></th>
                    <th width="50px"></th>
                </tr>

            <?php foreach ($this->species->commonNames as $common): ?>
                <tr>
                    <td><?php echo $common['common_name']; ?></td>
                    <td><?php echo $common['language'] ? $common['language'] : '-'; ?></td>
                    <td><?php echo $common['country'] ? $common['country'] : '-'; ?></td>
                    <td align="right">
                        <?php if($common['references']): ?>
                        <a href="<?php echo $this->baseUrl() .
                          '/details/reference/id/' . $common['references']; ?>">
                        <img
					    src="<?php echo $this->baseUrl() . '/images/book.gif'; ?>"
					    alt="<?php echo $this->translate('Click_here_to_show_the_literature_reference'); ?>"
					    title="<?php echo $common['referenceLabel']; ?>"/></a>
					    <?php endif; ?>
					</td>
                </tr>
            <?php endforeach; ?>
            </table>
        <?php else: echo $this->species->commonNames; endif; ?></td>
    </tr>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd");?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Classification'); ?>:</th>
        <td><?php if (is_array($this->species->hierarchy)): ?>
            <table>
                <tr>
                    <th width="150px"><?php echo $this->translate('Rank'); ?></th>
                    <th width="150px"><?php echo $this->translate('Taxonomic_Name'); ?></th>
                    <th><?php echo $this->translate('LSID'); ?></th>
                </tr>
        
                <?php
                $latest = count($this->species->hierarchy) - 1;
                $i = 0;
                foreach ($this->species->hierarchy as $hierarchy):
                if ($i != $latest):
                ?>
                <tr>
                    <td><?php echo $hierarchy['taxon']; ?></td>
                    <td><a href="<?php echo $this->baseUrl() . '/browse/tree/id/' .
                      $hierarchy['record_id']; ?>">
                        <?php echo $hierarchy['taxon'] == 'Species' ?
                         "<i>$hierarchy[name]</i>" : $hierarchy['name']; ?>
                        </a></td>
                    <td class="lsid"><?php echo $hierarchy['LSID']; ?></td>
                </tr>
                <?php
                endif;
                $i++;
                endforeach; ?>
            </table>
         <?php endif; ?></td>
     </tr>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd");?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Distribution'); ?>:</th>
        <td><?php echo ($this->species->distribution != '' ? $this->species->distribution : '-'); ?></td>
    </tr>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd");?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Additional_data'); ?>:</th>
        <td><?php echo $this->species->comment . '<br />';
        ?></td>
    </tr>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd");?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Source_database'); ?>:</th>
        <td><a href="<?php echo $this->baseUrl() . '/details/database/id/' . $this->species->dbId; ?>"><?php
          echo $this->species->dbName . '</a>, ' . $this->species->dbVersion;
        ?></td>
    </tr>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd");?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Latest_taxonomic_scrutiny'); ?>:</th>
        <td><?php echo $this->species->specialistName;
            if($this->species->specialistName != ''):
                echo ', ';
            endif;
            echo $this->species->scrutinyDate;
        ?></td>
    </tr>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd");?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('Online_resource'); ?>:</th>
        <td><a href="<?php echo $this->species->webSite; ?>"><?php
          echo $this->species->webSite; ?></a></td>
    </tr>
<?php $rowClass = ($rowClass == "odd" ? "even" : "odd");?>
    <tr class="<?php echo $rowClass; ?>">
        <th class="vertical"><?php echo $this->translate('CoL_taxon_LSID'); ?>:</th>
        <td><p class="lsid"><?php echo $this->species->lsid;
        ?></p></td>
    </tr>
</table>
        <?php
else:
?>
<p><?php echo $this->translate('Species_not_found'); ?></p>
<br/>
<?php
endif;
?>
<br/>
<div class="page_links">
<a href="javascript:history.back()">
    <?php echo $this->translate('Back_to_last_page'); ?>
</a> |
<a href="<?php echo $this->baseUrl() . '/search/' . $this->latestSearch; ?>">
    <?php echo $this->translate('New_search'); ?>
</a>
</div>